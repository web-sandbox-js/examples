(function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):(e=e||self,t(e.WebSandbox={}))})(this,function(e){'use strict';function t(e){return"function"==typeof e}function n(e,t=void 0){const n=`please report internal shim error: ${e}`;console.error(n),t&&(console.error(`${t}`),console.error(`${t.stack}`));debugger;throw n}function a(e,t){e||n(t)}function r(e){let t=`'use strict'; (${e})`;return t=t.replace(/\(0,\s*_[0-9a-fA-F]{3}\u200D\.e\)/g,"(0, eval)"),t=t.replace(/_[0-9a-fA-F]{3}\u200D\.g\./g,""),t=t.replace(/cov_[^+]+\+\+[;,]/g,""),t}function o(e,t){const{callAndWrapError:n}=e,{initRootRealm:a,initCompartment:o,getRealmGlobal:i,realmEvaluate:l}=t,{create:s,defineProperties:c}=Object;class d{constructor(){throw new TypeError("Realm is not a constructor")}static makeRootRealm(t={}){const o=s(d.prototype);return n(a,[e,o,t]),o}static makeCompartment(t={}){const a=s(d.prototype);return n(o,[e,a,t]),a}get global(){return n(i,[this])}evaluate(e,t,a={}){return n(l,[this,e,t,a])}}return c(d,{toString:{value:()=>"function Realm() { [shim code] }",writable:!1,enumerable:!1,configurable:!0}}),c(d.prototype,{toString:{value:()=>"[object Realm]",writable:!1,enumerable:!1,configurable:!0}}),d}function i(e,t=!1){function n(t,n,o,i){for(const l of t){const t=ge(e,l);t&&(a("value"in t,`unexpected accessor on global property: ${l}`),r[l]={value:t.value,writable:n,enumerable:o,configurable:i})}}const r={};return t?(n(De,!0,!1,!0),n(Ie,!0,!1,!0)):(n(De,!1,!1,!1),n(Ie,!1,!1,!1)),n(He,!0,!1,!0),r}function l(){function e(e){if(e===void 0||null===e)throw new TypeError(`can't convert undefined or null to object`);return Object(e)}function t(e){return"symbol"==typeof e?e:`${e}`}function n(e,t){if("function"!=typeof e)throw TypeError(`invalid ${t} usage`);return e}const{defineProperty:a,defineProperties:r,getOwnPropertyDescriptor:o,getPrototypeOf:i,prototype:l}=Object;try{(0,l.__lookupGetter__)("x")}catch(e){return}r(l,{__defineGetter__:{value:function(t,r){const o=e(this);a(o,t,{get:n(r,"getter"),enumerable:!0,configurable:!0})}},__defineSetter__:{value:function(t,r){const o=e(this);a(o,t,{set:n(r,"setter"),enumerable:!0,configurable:!0})}},__lookupGetter__:{value:function(n){let a=e(this);n=t(n);let r;for(;a&&!(r=o(a,n));)a=i(a);return r&&r.get}},__lookupSetter__:{value:function(n){let a=e(this);n=t(n);let r;for(;a&&!(r=o(a,n));)a=i(a);return r&&r.set}}})}function s(){function e(e,r){let o;try{o=(0,eval)(r)}catch(t){if(t instanceof SyntaxError)return;throw t}const i=n(o),l=function(){throw new TypeError("Not available")};t(l,{name:{value:e}}),t(i,{constructor:{value:l}}),t(l,{prototype:{value:i}}),l!==Function.prototype.constructor&&a(l,Function.prototype.constructor)}const{defineProperties:t,getPrototypeOf:n,setPrototypeOf:a}=Object;e("Function","(function(){})"),e("GeneratorFunction","(function*(){})"),e("AsyncFunction","(async function(){})"),e("AsyncGeneratorFunction","(async function*(){})")}function c(){const e=new Function("try {return this===global}catch(e){return false}")();if(!e)return;const t=require("vm"),n=t.runInNewContext(Ve);return n}function d(){if("undefined"!=typeof document){const e=document.createElement("iframe");e.style.display="none",document.body.appendChild(e);const t=e.contentWindow.eval(ke);return t}}function u(e,t=[],n=!1){const a=i(e,n),r=e.eval,o=e.Function,l=r(pe)();return Se({unsafeGlobal:e,sharedGlobalDescs:a,unsafeEval:r,unsafeFunction:o,callAndWrapError:l,allShims:t})}function m(e,t=!1){const n=Fe(),a=u(n,e,t),{unsafeEval:r}=a;return r(_e)(),r(je)(),a}function p(e,t={}){const n=he(e),a=Oe(n,n=>{if(n in t)return!1;if("eval"===n||Ue.has(n)||!Pe(We,n))return!1;const a=ge(e,n);return!1===a.configurable&&!1===a.writable&&Ae(a,"value")});return a}function f(e){const t=e.search(qe);if(-1!==t){const n=e.slice(0,t).split("\n").length;throw new SyntaxError(`possible html comment syntax rejected around line ${n}`)}}function b(e){const t=e.search(Xe);if(-1!==t){const n=e.slice(0,t).split("\n").length;throw new SyntaxError(`possible import expression rejected around line ${n}`)}}function S(e){const t=e.search(Ye);if(-1!==t){const n=e.slice(0,t).split("\n").length;throw new SyntaxError(`possible direct eval expression rejected around line ${n}`)}}function E(e){f(e),b(e),S(e)}function g(e){return 0===e.length?"":`const {${we(e,",")}} = this;`}function y(e,t){const{unsafeFunction:n}=e,a=g(t);return n(`with (arguments[0]) {${a};return function() {'use strict';return eval(arguments[0]);};}`)}function h(e,t,a,r){const{unsafeEval:o}=e,i=o(Ke);return function(l={},s={}){const c=s.transforms||[],d=Re(c,a||[],[Qe]);return function(a){let s={src:a,endowments:l};s=i(s,d);const c=p(t,s.endowments),u=p(s.endowments),m=Re(c,u),f=y(e,m),b=o(Be)(e,t,s.endowments,r),S=Proxy.revocable({},b),E=S.proxy,g=Ce(f,t,[E]);b.useUnsafeEvaluator=!0;let h;try{return Ce(g,t,[s.src])}catch(t){throw h=t,t}finally{b.useUnsafeEvaluator&&(S.revoke(),n("handler did not revoke useUnsafeEvaluator",h))}}}}function v(e,t){const{unsafeEval:n,unsafeFunction:r}=e,o=n(ze)(e,t);return a(ve(o).constructor!==Function,"hide Function"),a(ve(o).constructor!==r,"hide unsafeFunction"),o}function T(e){return(t,n,a={})=>e(n,a)(t)}function C(e,t){const{unsafeGlobal:n,unsafeEval:r,unsafeFunction:o}=e,i=r(Ge)(e,function(...e){const a=`${Le(e)||""}`;let r=`${we(e,",")}`;if(!Pe(/^[\w\s,]*$/,r))throw new SyntaxError("shim limitation: Function arg must be simple ASCII identifiers, possibly separated by commas: no default values, pattern matches, or non-ASCII parameter names");if(new o(a),xe(r,")"))throw new n.SyntaxError("shim limitation: Function arg string contains parenthesis");0<r.length&&(r+="\n/*``*/");const i=`(function(${r}){\n${a}\n})`;return t(i)});return a(ve(i).constructor!==Function,"hide Function"),a(ve(i).constructor!==o,"hide unsafeFunction"),i}function N(e){return a(Object(e)===e,"bad object, not a Realm instance"),a(Je.has(e),"Realm instance has no record"),Je.get(e)}function M(e,t){a(Object(e)===e,"bad object, not a Realm instance"),a(!Je.has(e),"Realm instance already has a record"),Je.set(e,t)}function A(e,t,n){Ee(e,{eval:{value:t,writable:!0,configurable:!0},Function:{value:n,writable:!0,configurable:!0}})}function O(e,t,n){const{sharedGlobalDescs:a,unsafeGlobal:r}=e,o=be(r.Object.prototype,a),i=h(e,o,t,n),l=i(),s=v(e,l),c=C(e,l),d=T(i);A(o,s,c);const u=Se({safeGlobal:o,safeEval:s,safeEvalWhichTakesEndowments:d,safeFunction:c});return u}function L(){return window.document.createElement("web-sandbox")}const{document:w}=window,R=e=>{if("string"==typeof e&&["","module","application/javascript","application/ecmascript","text/javascript","text/ecmascript"].includes(e.trim().toLowerCase()))return!0;let t=window.WEBSANDBOX_PREVENT_SCRIPT_TYPE;if(t||(t=window.WEBSANDBOX_PREVENT_SCRIPT_TYPE=new Map),t.has(e))return t.get(e);t.set(e,!1);const n=w.createElement("script");n.setAttribute("type",e),n.textContent=`${"WEBSANDBOX_PREVENT_SCRIPT_TYPE"}.set(${JSON.stringify(e)}, true)`,w.head.appendChild(n);const a=t.get(e);return w.head.removeChild(n),a},{assign:P,create:x,defineProperties:D,defineProperty:I,entries:H,freeze:k,fromEntries:V,getOwnPropertyDescriptor:F,getOwnPropertyDescriptors:_,getOwnPropertyNames:j,getOwnPropertySymbols:W,getPrototypeOf:U,is:B,isExtensible:z,isFrozen:G,isSealed:K,keys:q,preventExtensions:X,seal:Y,setPrototypeOf:Q,values:J}=Object,{from:Z}=Array,{apply:$,construct:ee,deleteProperty:te,get:ne,has:ae,ownKeys:re,set:oe}=Reflect;let ie;const le=t(window.queueMicrotask)?window.queueMicrotask.bind(window):e=>(ie||(ie=Promise.resolve())).then(e).catch(e=>window.setTimeout(()=>{throw e},0));var se=Object.freeze({__proto__:null,assign:P,create:x,defineProperties:D,defineProperty:I,entries:H,freeze:k,fromEntries:V,getOwnPropertyDescriptor:F,getOwnPropertyDescriptors:_,getOwnPropertyNames:j,getOwnPropertySymbols:W,getPrototypeOf:U,is:B,isExtensible:z,isFrozen:G,isSealed:K,keys:q,preventExtensions:X,seal:Y,setPrototypeOf:Q,values:J,from:Z,apply:$,construct:ee,deleteProperty:te,get:ne,has:ae,ownKeys:re,set:oe,isArray:function(e){return Array.isArray(e)},isBoolean:function(e){return"boolean"==typeof e},isNull:function(e){return null===e},isNumber:function(e){return"number"==typeof e},isString:function(e){return"string"==typeof e},isObject:function(e){return"object"==typeof e&&null!==e},isFunction:t,hasOwnProperty:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},toString:function(e){return Object.prototype.toString.call(e)},inherits:function(e,t){return new Proxy(e,{get(e,n,a){const r=ae(e,n)?[e,n,a]:[t,n];return ne(...r)},has(e,n){return ae(e,n)||ae(t,n)},ownKeys(e){return new Set(...re(e),...re(t))},set(e,n,a,r){const o=ae(e,n)?[e,n,a,r]:[t,n,a];return oe(...o)},deleteProperty(e,n){return te(ae(e,n)?e:t,n)},getOwnPropertyDescriptor(e,n){return F(ae(e,n)?e:t,n)}})},queueMicrotask:le}),ce=({compartment:e,csp:t,debug:n,documentView:a,namespace:r,parent:o,permissions:i,title:l,top:s,windowView:c},{apply:d,construct:u,defineProperty:m,getPrototypeOf:p,isFunction:f,isObject:b,toString:S})=>{const E={};E.bridge=E,E.title=l,E.namespace=r,E.permissions=i,E.compartment=e,E.global=e.global,E.top=s,E.parent=o,E.debug=n,E.windowView=c,E.documentView=a,E.csp=t;let g=null;return E.getCurrentNativeObject=function(){return g},E.setCurrentNativeObject=function(e){g=e},E.SandboxSecurityError=class extends TypeError{constructor(){super(...arguments),this.name="WebSandboxSecurityError"}},E.toNativeObject=function(e){const t=E.toNativeObject.cache.get(e);return t?t:e},E.toNativeObject.cache=new WeakMap,E.toVirtualObject=function(e){if(E.toVirtualObject.cache.has(e))return E.toVirtualObject.cache.get(e);let t;if(e===E.windowView)t=E.classRegistry.get("Window");else if(e===E.documentView)t=E.classRegistry.get("HTMLDocument");else{const n=p(e);if(n){const a=n.constructor,r=a&&a.name||e[Symbol.toStringTag];t=E.classRegistry.get(r)}}if(!t||[E.parent,E.parent.document].includes(e)||e.isConnected&&e instanceof E.parent.Node&&E.parent.document.documentElement.contains(e))throw new E.SandboxSecurityError(`Forbidden: ${S(e)}`);E.setCurrentNativeObject(e);const n=u(t,[]);return E.setCurrentNativeObject(null),E.bindObject(n,e),n},E.toVirtualObject.cache=new WeakMap,E.toLiveVirtuaObject=(e)=>new Proxy(e,["getPrototypeOf","setPrototypeOf","isExtensible","preventExtensions","getOwnPropertyDescriptor","defineProperty","has","get","set","deleteProperty","ownKeys"].reduce((e,t)=>(e[t]=(...e)=>E.toVirtualAny(Reflect[t](...e.map(e=>E.toNativeAny(e)))),e),{})),E.bindObject=function(e,t){E.toNativeObject.cache.set(e,t),E.toVirtualObject.cache.set(t,e)},E.toNativeFunction=function(e){if(E.toNativeFunction.cache.has(e))return E.toNativeFunction.cache.get(e);const t=e=>e.map(e=>E.toVirtualAny(e)),n=function(...n){const a=this,r=a?E.toVirtualObject(a):void 0,o=t(n),i=d(e,r,o);return E.toNativeAny(i)};return m(n,"name",{value:e.name,configurable:!0}),E.toNativeFunction.cache.set(e,n),n},E.toNativeFunction.cache=new WeakMap,E.toVirtualFunction=function(e){if(E.toVirtualFunction.cache.has(e))return E.toVirtualFunction.cache.get(e);const t=e=>e.map(e=>E.toNativeAny(e)),n=function(...n){const a=this,r=a?E.toNativeObject(a):void 0,o=t(n),i=d(e,r,o);return E.toVirtualAny(i)};return m(n,"name",{value:e.name,configurable:!0}),E.toVirtualFunction.cache.set(e,n),n},E.toVirtualFunction.cache=new WeakMap,E.toVirtualAny=function(e){return b(e)?E.toVirtualObject(e):f(e)?E.toVirtualFunction(e):e},E.toNativeAny=function(e){return b(e)?E.toNativeObject(e):f(e)?E.toNativeFunction(e):e},E.classRegistry=new Map,E},de=({bindObject:e,bridge:t,classRegistry:n,compartment:a,csp:r,debug:o,documentView:i,getCurrentNativeObject:l,global:s,parent:c,permissions:d,SandboxSecurityError:u,setCurrentNativeObject:m,toLiveVirtuaObject:p,toNativeAny:f,top:b,toVirtualAny:S,windowView:E},{construct:g,create:y,cspParser:h,defineProperties:v,defineProperty:T,entries:C,getOwnPropertyDescriptor:N,getPrototypeOf:M,hasOwnProperty:A,inherits:O,isArray:L,isFunction:w,isJavaScriptType:R,isObject:P,keys:x,ownKeys:D,queueMicrotask:I,Sanitizer:H,setPrototypeOf:k,utils:V})=>{const F={},_=h(r),j={Window:E.constructor,Document:i.constructor};F.prefix=`${E.localName}.`,F.scriptType=`${F.prefix}script`,F.elementDefined=`${F.prefix}defined`,F.symbols={initialize:Symbol("initialize"),connectedCallback:Symbol("connectedCallback"),disconnectedCallback:Symbol("disconnectedCallback"),attributeChangedCallback:Symbol("attributeChangedCallback")},F.cspSandboxCheck=(e,t=!0)=>!!(_.sandbox&&_.sandbox.includes(e))||(t&&F.console.error(`The document is sandboxed, and the '${e}' keyword is not set.`),!1),F.console=C(c.console).reduce((e,[t,n])=>(e[t]=o?n:function(){n(...arguments)},e),{});let W=null;return F.getCurrentScript=()=>W,F.setCurrentScript=e=>{W=e},F.runScript=({src:e,textContent:t,element:n=null})=>{const r=b.fetch,o=s.Error,i=e=>{F.setCurrentScript(n);try{a.evaluate(e)}catch(e){I(()=>{throw e})}F.setCurrentScript(null)};return e?r(e,{credentials:"same-origin"}).then(t=>{if(!t.ok)throw o([t.status,t.statusText,e].join(", "));const n=t.headers.get("content-type");if(!n||!/^(text|application)\/(x-)?javascript(;|$)/.test(n))throw o(n);return t.text().then(t=>{const n=/(\/\/# sourceURL=)((https?:\/\/)?([\w-])+\.{1}([a-zA-Z]{2,63})([/\w-]*)*\/?\??([^#\n\r]*)?)/;n.test(t)?t=t.replace(n,(t,n,a)=>`${n}${b.URL(a,e).href}`):t+=`\n//# sourceURL=${e}`,i(t)})}):(t&&i(t),Promise.resolve())},F.sanitizer=new H({...["allowElements","blockElements","dropElements","allowAttributes","dropAttributes"].reduce((e,t)=>(e[t]=d[t],e),{}),uponSanitizeElement(e,t){"script"===t.tagName&&R(e.type)?e.setAttribute("type",F.scriptType):c.customElements.get(t.tagName)&&e.parentNode.removeChild()}}),F.runFunction=e=>o?e(t,V):a.evaluate(e.toString())(t,V),F.configToMap=e=>{const t=e=>{const t=new Map,n=new Set(["arguments","caller","length","name","prototype"]),a=new Set(["constructor"]),r=(e,t)=>[...x(e).filter(e=>!n.has(e)),...x(t).filter(e=>!a.has(e))];return e.forEach(e=>{const n=e.name||e,a=e.value,o=c[n]||{},i=o.prototype||{};L(a)?t.set(n,new Set(a)):t.set(n,new Set(r(o,i)))}),t};return{allowInterfaces:t(e.allowInterfaces),blockInterfaces:t(e.blockInterfaces)}},F.createVirtualClass=(t,n={},r)=>{const o=c[t],i=N(n,F.symbols.initialize),s=a.evaluate(`(function ${t}(){return constructor.call(this,...arguments)})`,{constructor:function(){let t=this,n=l();if(n)e(t,n),r&&g(r,arguments,s);else{const a=Array.from(arguments).map(e=>f(e));if(!(this instanceof s))return n=o(...a),S(n);n=g(o,a),P(n)&&e(t,n)}return i&&(m(n),t=i.value.call(t)),t}}),d={constructor:{configurable:!0,value:s,writable:!0},[Symbol.toStringTag]:{configurable:!0,value:o.prototype&&o.prototype[Symbol.toStringTag]||t},...D(n).reduce((e,t)=>(e[t]=N(n,t),e),{})};return r?(k(s,r),s.prototype=y(r.prototype,d)):v(s.prototype,d),T(s,"toString",{configurable:!0,value(){return`function ${t}() { [virtual code] }`},writable:!0}),s},F.interfaceGenerator=(e,t)=>{const a=F.configToMap(d),r=(a,o)=>{if(s[a])return s[a];if(!o.has(a))throw new u(`"${a}" is not in the allowed list`);if(n.has(a))return n.get(a);const i=c[a],d=j[a]||i;if(!P(i)&&!w(i))return i;const m=M(i),f=m.name;f&&!n.get(f)&&r(f,o);const b=e[a]||{},S=t.includes(a);S&&(b[F.symbols.initialize]=function(){return O(this,p(l(),!0))});const E=n.get(m.name),g=F.createVirtualClass(a,b,E);return F.importPropertys(g,d,[...o.get(a).values()]),n.set(a,g),g};return[...a.allowInterfaces.keys()].reduce((e,t)=>{const n=r(t,a.allowInterfaces);return n&&(e[t]=n),e},{})},F.importPropertys=(e,t,n)=>{const a=(e,t)=>{const n=N(e,t);if(!n){const n=M(e);return n?a(n,t):void 0}return n},r=(e,t,n)=>{if(!A(e,n)){const r=a(t,n);r&&(D(r).forEach(e=>{r[e]=S(r[e])}),T(e,n,r))}};n.forEach(n=>{r(e,t,n),w(t)&&t.prototype&&r(e.prototype,t.prototype,n)})},F},ue=(e,t)=>{const n=e.compartment,a=(e,a)=>a.debug?e(a,t):n.evaluate(e.toString())(a,t),r=a(ce,e);return t.assign(r,a(de,r)),r};const me=r(o),pe=r(function(){const{getPrototypeOf:e}=Object,{apply:t}=Reflect,n=e=>(n,...a)=>t(e,n,a),a=n(Map.prototype.get),r=n(Set.prototype.has),o=new Map([["EvalError",EvalError],["RangeError",RangeError],["ReferenceError",ReferenceError],["SyntaxError",SyntaxError],["TypeError",TypeError],["URIError",URIError]]),i=new Set([EvalError.prototype,RangeError.prototype,ReferenceError.prototype,SyntaxError.prototype,TypeError.prototype,URIError.prototype,Error.prototype]);return function(n,l){try{return t(n,void 0,l)}catch(t){if(Object(t)!==t)throw t;if(r(i,e(t)))throw t;let n,l,s;try{n=`${t.name}`,l=`${t.message}`,s=`${t.stack||l}`}catch(e){throw new Error("unknown error")}const c=a(o,n)||Error;try{throw new c(l)}catch(e){throw e.stack=s,e}}}}),{assign:fe,create:be,freeze:Se,defineProperties:Ee,getOwnPropertyDescriptor:ge,getOwnPropertyDescriptors:ye,getOwnPropertyNames:he,getPrototypeOf:ve,setPrototypeOf:Te}=Object,{apply:Ce,ownKeys:Ne}=Reflect,Me=e=>(t,...n)=>Ce(e,t,n),Ae=Me(Object.prototype.hasOwnProperty),Oe=Me(Array.prototype.filter),Le=Me(Array.prototype.pop),we=Me(Array.prototype.join),Re=Me(Array.prototype.concat),Pe=Me(RegExp.prototype.test),xe=Me(String.prototype.includes),De=["Infinity","NaN","undefined"],Ie=["isFinite","isNaN","parseFloat","parseInt","decodeURI","decodeURIComponent","encodeURI","encodeURIComponent","Array","ArrayBuffer","Boolean","DataView","EvalError","Float32Array","Float64Array","Int8Array","Int16Array","Int32Array","Map","Number","Object","RangeError","ReferenceError","Set","String","Symbol","SyntaxError","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","URIError","WeakMap","WeakSet","JSON","Math","Reflect","escape","unescape"],He=["Date","Error","Promise","Proxy","RegExp","Intl"],ke="'use strict'; this",Ve=`(0, eval)("'use strict'; this")`,Fe=()=>{const e=d(),t=c();if(!e&&!t||e&&t)throw new Error("unexpected platform, unable to create Realm");return e||t},_e=r(l),je=r(s),We=/^[a-zA-Z_$][\w$]*$/,Ue=new Set(["await","break","case","catch","class","const","continue","debugger","default","delete","do","else","export","extends","finally","for","function","if","import","in","instanceof","new","return","super","switch","this","throw","try","typeof","var","void","while","with","yield","let","static","enum","implements","package","protected","interface","private","public","await","null","true","false","this","arguments"]),Be=r(function(e,t,n={},a=!1){const{unsafeGlobal:r,unsafeEval:o}=e,{freeze:i,getOwnPropertyDescriptor:l}=Object,{get:s,set:c}=Reflect,d=new Proxy(i({}),{get(e,t){throw new TypeError(`unexpected scope handler trap called: ${t+""}`)}});return{__proto__:d,useUnsafeEvaluator:!1,get(e,a){return"symbol"==typeof a?void 0:"eval"===a&&!0===this.useUnsafeEvaluator?(this.useUnsafeEvaluator=!1,o):a in n?s(n,a,t):s(t,a)},set(e,a,r){if(a in n){const e=l(n,a);return"value"in e?c(n,a,r):c(n,a,r,t)}return c(t,a,r)},has(e,o){return!!a||!!("eval"===o||o in n||o in t||o in r)},getPrototypeOf(){return null}}}),ze=r(function(e,t){const{callAndWrapError:n}=e,{defineProperties:a}=Object,r={eval(){return n(t,arguments)}}.eval;return a(r,{toString:{value:()=>`function ${"eval"}() { [shim code] }`,writable:!1,enumerable:!1,configurable:!0}}),r}),Ge=r(function(e,t){const{callAndWrapError:n,unsafeFunction:a}=e,{defineProperties:r}=Object,o=function(){return n(t,arguments)};return r(o,{prototype:{value:a.prototype},toString:{value:()=>"function Function() { [shim code] }",writable:!1,enumerable:!1,configurable:!0}}),o}),Ke=r(function(e,t){const{create:n,getOwnPropertyDescriptors:a}=Object,{apply:r}=Reflect,o=(e=>(t,...n)=>r(e,t,n))(Array.prototype.reduce);return e={src:`${e.src}`,endowments:n(null,a(e.endowments))},e=o(t,(e,t)=>t.rewrite?t.rewrite(e):e,e),e={src:`${e.src}`,endowments:n(null,a(e.endowments))},e}),qe=/(?:<!--|-->)/,Xe=/\bimport\s*(?:\(|\/[/*])/,Ye=/\beval\s*(?:\(|\/[/*])/,Qe={rewrite(e){return E(e.src),e}},Je=new WeakMap,Ze={initRootRealm:function(e,t,n){const{shims:a,transforms:r,sloppyGlobals:o,configurableGlobals:i}=n,l=Re(e.allShims,a),s=m(l,i),{unsafeEval:c}=s,d=c(me)(s,Ze);s.sharedGlobalDescs.Realm={value:d,writable:!0,configurable:!0};const u=O(s,r,o),{safeEvalWhichTakesEndowments:p}=u;for(const a of l)p(a);M(t,u)},initCompartment:function(e,t,n={}){const{transforms:a,sloppyGlobals:r}=n,o=O(e,a,r);M(t,o)},getRealmGlobal:function(e){const{safeGlobal:t}=N(e);return t},realmEvaluate:function(e,t,n={},a={}){const{safeEvalWhichTakesEndowments:r}=N(e);return r(t,n,a)}},$e=function(){const e=eval,t=e(ke);return l(),s(),u(t)}(),et=o($e,Ze);let tt;var nt=()=>{if(!tt){tt=et.makeRootRealm();const e=window.document.body.lastChild;if("IFRAME"===e.nodeName&&e.contentWindow&&tt.global instanceof e.contentWindow.Object){const t=e.contentDocument;t.removeChild(t.documentElement),Object.defineProperties(e,{contentWindow:{},contentDocument:{}})}}const e=tt.global.Realm.makeCompartment(),t=e.evaluate;return e.evaluate=function(e,...n){return e=e.replace(/\.import\(/g,`['import'](`),t.call(this,e,...n)},e},at=({bridge:e,classRegistry:t,compartment:n,cspSandboxCheck:a,documentView:r,parent:o})=>{const i=t=>n.evaluate(((e,t)=>()=>{a(t)}).toString())(e,t);[["allow-top-navigation","HTMLAnchorElement","click"],["allow-forms","HTMLFormElement","submit"]].forEach(([e,n,l,s])=>{a(e,!1)||(r.addEventListener(s||l,t=>{t.target instanceof o[n]&&!a(e)&&t.preventDefault()},!0),t.get(n).prototype[l]=i(l))})},rt=["Array","AudioParamMap","CSSKeyframesRule","CSSNumericArray","CSSRuleList","CSSStyleDeclaration","CSSTransformValue","CSSUnparsedValue","DataTransferItemList","DOMRectList","DOMStringList","DOMTokenList","EventCounts","FileList","FormData","Headers","HTMLAllCollection","HTMLCollection","HTMLFormControlsCollection","HTMLFormElement","HTMLOptionsCollection","HTMLSelectElement","KeyboardLayoutMap","MediaKeyStatusMap","MediaList","MIDIInputMap","MIDIOutputMap","MimeTypeArray","NamedNodeMap","NodeList","Object","Plugin","PluginArray","Promise","RadioNodeList","RTCStatsReport","SourceBufferList","StylePropertyMap","StylePropertyMapReadOnly","StyleSheetList","SVGLengthList","SVGNumberList","SVGPointList","SVGStringList","SVGTransformList","TextTrackCueList","TextTrackList","TouchList","XRAnchorSet","XRInputSourceArray"];const ot=(e,t=/^(on)[\w]+/)=>Object.keys("string"==typeof e?window[e].prototype:e).filter(e=>t.test(e));var it={allowInterfaces:["AggregateError","AnalyserNode","Animation","AnimationEffect","AnimationEvent","AnimationPlaybackEvent","AnimationTimeline","atob","Atomics","Attr","Audio","AudioBuffer","AudioBufferSourceNode","AudioContext","AudioDestinationNode","AudioListener","AudioNode","AudioParam","AudioParamMap","AudioProcessingEvent","AudioScheduledSourceNode","BaseAudioContext","BeforeUnloadEvent","Blob","BlobEvent","blur","btoa","ByteLengthQueuingStrategy","cancelAnimationFrame","CanvasCaptureMediaStreamTrack","CanvasGradient","CanvasPattern","CanvasRenderingContext2D","CDATASection","ChannelMergerNode","ChannelSplitterNode","CharacterData","clearInterval","clearTimeout","Clipboard","ClipboardEvent","ClipboardItem","close","closed","Comment","CompositionEvent","CompressionStream","console","ConstantSourceNode","ConvolverNode","CountQueuingStrategy","createImageBitmap","CSS","CSS2Properties","CSSAnimation","CSSConditionRule","CSSFontFaceRule","CSSGroupingRule","CSSImageValue","CSSImportRule","CSSKeyframeRule","CSSKeyframesRule","CSSKeywordValue","CSSMathInvert","CSSMathMax","CSSMathMin","CSSMathNegate","CSSMathProduct","CSSMathSum","CSSMathValue","CSSMatrixComponent","CSSMediaRule","CSSNamespaceRule","CSSNumericArray","CSSNumericValue","CSSPageRule","CSSPerspective","CSSPositionValue","CSSPropertyRule","CSSRotate","CSSRule","CSSRuleList","CSSScale","CSSSkew","CSSSkewX","CSSSkewY","CSSStyleDeclaration","CSSStyleRule","CSSStyleSheet","CSSStyleValue","CSSSupportsRule","CSSTransformComponent","CSSTransformValue","CSSTransition","CSSTranslate","CSSUnitValue","CSSUnparsedValue","CSSVariableReferenceValue","CustomElementRegistry","customElements","CustomEvent","DataTransfer","DataTransferItem","DataTransferItemList","DelayNode","DeviceMotionEvent","DeviceMotionEventAcceleration","DeviceMotionEventRotationRate","DeviceOrientationEvent","devicePixelRatio",{name:"Document",value:["activeElement","adoptNode","body","characterSet","childElementCount","children","contentType","createAttribute","createAttributeNS","createCDATASection","createComment","createDocumentFragment","createElement","createElementNS","createEvent","createNodeIterator","createProcessingInstruction","createTextNode","createTreeWalker","defaultView","documentElement","documentURI","domain","firstElementChild","getAnimations","getElementById","getElementsByClassName","getElementsByName","getElementsByTagName","getElementsByTagNameNS","head","hidden","importNode","lastElementChild",...ot("Document"),"querySelector","querySelectorAll","readyState","styleSheets","title","URL","visibilityState"]},{name:"DocumentFragment",value:["append","childElementCount","children","firstElementChild","getElementById","lastElementChild","prepend","querySelector","querySelectorAll","replaceChildren"]},"DocumentTimeline","DOMError","DOMException","DOMMatrix","DOMMatrixReadOnly","DOMPoint","DOMPointReadOnly","DOMQuad","DOMRect","DOMRectList","DOMRectReadOnly","DOMStringList","DOMStringMap","DOMTokenList","DragEvent","DynamicsCompressorNode",{name:"Element",value:["after","animate","append","attachShadow","attributes","attributeStyleMap","before","childElementCount","children","classList","className","clientHeight","clientLeft","clientTop","clientWidth","closest","computedStyleMap","firstElementChild","getAnimations","getAttribute","getAttributeNames","getAttributeNode","getAttributeNodeNS","getAttributeNS","getBoundingClientRect","getClientRects","getElementsByClassName","getElementsByTagName","getElementsByTagNameNS","hasAttribute","hasAttributeNS","hasAttributes","id","innerHTML","insertAdjacentElement","insertAdjacentHTML","insertAdjacentText","lastElementChild","localName","matches","namespaceURI","nextElementSibling","outerHTML","part","prefix","previousElementSibling","querySelector","querySelectorAll","remove","removeAttribute","removeAttributeNode","removeAttributeNS","scroll","scrollBy","scrollHeight","scrollIntoView","scrollLeft","scrollTo","scrollTop","scrollWidth","setAttribute","setAttributeNode","setAttributeNodeNS","setAttributeNS","shadowRoot","tagName","toggleAttribute",...ot("Element",/^(aria|on)[\w]+/)]},"ElementInternals","ErrorEvent",{name:"Event",value:["bubbles","cancelable","currentTarget","defaultPrevented","eventPhase","initEvent","preventDefault","stopImmediatePropagation","stopPropagation","target","timeStamp","type"]},{name:"EventTarget",value:["addEventListener","dispatchEvent","removeEventListener"]},"focus","FocusEvent","FontFace","FontFaceSetLoadEvent","GainNode","getComputedStyle","HashChangeEvent","HTMLAllCollection","HTMLAnchorElement","HTMLAreaElement","HTMLAudioElement","HTMLQuoteElement",{name:"HTMLBodyElement",value:ot("HTMLBodyElement")},"HTMLBRElement","HTMLButtonElement","HTMLCanvasElement","HTMLCollection","HTMLTableCaptionElement","HTMLTableColElement","HTMLDataElement","HTMLDataListElement","HTMLDocument",{name:"HTMLElement",value:["accessKey","autofocus","blur","click","dataset","dir","draggable","focus","hidden","innerText","lang","offsetHeight","offsetLeft","offsetParent","offsetTop","offsetWidth",...ot("HTMLElement"),"spellcheck","style","tabIndex","title"]},"HTMLModElement","HTMLDetailsElement","HTMLDialogElement","HTMLDivElement","HTMLDListElement","HTMLFieldSetElement","HTMLFormElement","HTMLHeadingElement","HTMLHeadElement","HTMLHRElement","HTMLHtmlElement","HTMLImageElement","HTMLInputElement","HTMLLabelElement","HTMLLegendElement","HTMLLIElement","HTMLLinkElement","HTMLMapElement","HTMLMediaElement","HTMLMeterElement","HTMLMenuElement","HTMLOListElement","HTMLOptGroupElement","HTMLOptionElement","HTMLOptionsCollection","HTMLOutputElement","HTMLParagraphElement","HTMLPictureElement","HTMLPreElement","HTMLProgressElement","HTMLScriptElement","HTMLSelectElement",{name:"HTMLSlotElement",value:[]},"HTMLSourceElement","HTMLSpanElement","HTMLStyleElement","HTMLTableElement","HTMLTableSectionElement","HTMLTableCellElement","HTMLTemplateElement","HTMLTextAreaElement","HTMLTimeElement","HTMLTitleElement","HTMLTableRowElement","HTMLTrackElement","HTMLUListElement","HTMLUnknownElement","HTMLVideoElement","IIRFilterNode","Image","ImageBitmap","ImageBitmapRenderingContext","ImageCapture","ImageData","innerHeight","innerWidth","InputEvent","Keyboard","KeyboardEvent","KeyboardLayoutMap","KeyframeEffect",{name:"localStorage",value:[]},"Location","location","matchMedia","MediaCapabilities","MediaDeviceInfo","MediaDevices","MediaElementAudioSourceNode","MediaError","MediaKeyMessageEvent","MediaKeys","MediaKeySession","MediaKeyStatusMap","MediaKeySystemAccess","MediaList","MediaMetadata","MediaQueryList","MediaQueryListEvent","MediaRecorder","MediaSession","MediaSource","MediaStream","MediaStreamAudioDestinationNode","MediaStreamAudioSourceNode","MediaStreamTrack","MediaStreamTrackEvent","menubar","MessageChannel","MessageEvent","MessagePort",{name:"MouseEvent",value:["altKey","button","ctrlKey","metaKey","offsetX","offsetY","relatedTarget","shiftKey","x","y"]},"MutationObserver","MutationRecord","name","NamedNodeMap","NavigationPreloadManager",{name:"Navigator",value:["language","languages","userAgent"]},"navigator",{name:"Node",value:["appendChild","ATTRIBUTE_NODE","baseURI","CDATA_SECTION_NODE","childNodes","cloneNode","COMMENT_NODE","contains","DOCUMENT_FRAGMENT_NODE","DOCUMENT_NODE","DOCUMENT_POSITION_CONTAINED_BY","DOCUMENT_POSITION_CONTAINS","DOCUMENT_POSITION_DISCONNECTED","DOCUMENT_POSITION_FOLLOWING","DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC","DOCUMENT_POSITION_PRECEDING","DOCUMENT_TYPE_NODE","ELEMENT_NODE","ENTITY_NODE","ENTITY_REFERENCE_NODE","firstChild","hasChildNodes","insertBefore","isConnected","isEqualNode","lastChild","nextSibling","nodeName","nodeType","nodeValue","normalize","NOTATION_NODE","ownerDocument","parentNode","previousSibling","PROCESSING_INSTRUCTION_NODE","removeChild","replaceChild","textContent","TEXT_NODE"]},"NodeFilter","NodeIterator","NodeList","Notification","OfflineAudioCompletionEvent","OfflineAudioContext","offscreenBuffering","OffscreenCanvas","OffscreenCanvasRenderingContext2D",...ot(window),"outerHeight","outerWidth","OverconstrainedError","PageTransitionEvent","pageXOffset","pageYOffset","Path2D","RadioNodeList","requestAnimationFrame","requestIdleCallback","ResizeObserver","ResizeObserverEntry","ResizeObserverSize","setInterval","setTimeout",{name:"ShadowRoot",value:["activeElement","delegatesFocus","getAnimations","host","innerHTML","mode","styleSheets"]},"SharedArrayBuffer","SourceBuffer","SourceBufferList","speechSynthesis","SpeechSynthesisErrorEvent","SpeechSynthesisEvent","SpeechSynthesisUtterance",{name:"Storage",value:["clear","getItem","key","length","removeItem","setItem"]},"StorageEvent","StorageManager","styleMedia","StylePropertyMap","StylePropertyMapReadOnly","StyleSheet","StyleSheetList","SubmitEvent",{name:"Text",value:["wholeText"]},"TextDecoder","TextDecoderStream","TextEncoder","TextEncoderStream","TextEvent","TextMetrics","TextTrack","TextTrackCue","TextTrackCueList","TextTrackList","Touch","TouchEvent","TouchList","TrackEvent","TransformStream","TransitionEvent","TreeWalker","TrustedHTML","TrustedScript","TrustedScriptURL","TrustedTypePolicy","TrustedTypePolicyFactory","trustedTypes",{name:"UIEvent",value:["detail"]},"URL","URLSearchParams","VideoPlaybackQuality","WebGL2RenderingContext","WebGLActiveInfo","WebGLBuffer","WebGLContextEvent","WebGLFramebuffer","WebGLProgram","WebGLQuery","WebGLRenderbuffer","WebGLRenderingContext","WebGLSampler","WebGLShader","WebGLShaderPrecisionFormat","WebGLSync","WebGLTexture","WebGLTransformFeedback","WebGLUniformLocation","WebGLVertexArrayObject","WheelEvent",{name:"Window",value:[]},"WritableStream","WritableStreamDefaultWriter"],blockInterfaces:[],allowElements:[],blockElements:[],dropElements:[],allowAttributes:[],dropAttributes:[]};const lt=Object.seal(/^data-[\-\w.\u00B7-\uFFFF]/),st=Object.seal(/^aria-[\-\w]+$/),ct=Object.seal(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),dt=Object.seal(/^(?:\w+script|data):/i),ut=Object.seal(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),{Node:mt,NodeFilter:pt,Text:ft,Comment:bt,NamedNodeMap:St,DocumentFragment:Et,document:gt}=window,yt=Symbol("executeHook"),ht=Symbol("sanitizeElements"),vt=Symbol("sanitizeAttributes"),Tt=Symbol("sanitizeShadowDOM"),Ct=Symbol("sanitize"),Nt=["base","embed","iframe","meta","noscript","object","param","frame","frameset","noframes"],Mt=["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"],At=["audio","video","img","source","image","track"],Ot=["alt","class","for","id","label","name","pattern","placeholder","summary","title","value","style","xmlns"],Lt=gt.createElement("form"),wt=e=>{try{e.parentNode.removeChild(e)}catch(t){try{e.outerHTML=""}catch(t){e.remove()}}},Rt=function(e,t){if(t.removeAttribute(e),"is"===e)try{t.setAttribute(e,"")}catch(e){}},Pt=e=>{const t=e.match(/^[\r\n\t ]+/),n=t&&t[0],a=gt.implementation.createHTMLDocument(""),{body:r}=a;return r.innerHTML=e,e&&n&&a.body.insertBefore(gt.createTextNode(n),a.body.childNodes[0]||null),r},xt=e=>(e.ownerDocument||e).createNodeIterator(e,pt.SHOW_ELEMENT|pt.SHOW_COMMENT|pt.SHOW_TEXT,()=>pt.FILTER_ACCEPT,!1),Dt=e=>!(e instanceof ft||e instanceof bt)&&!("string"==typeof e.nodeName&&"string"==typeof e.textContent&&"function"==typeof e.removeChild&&e.attributes instanceof St&&"function"==typeof e.removeAttribute&&"function"==typeof e.setAttribute&&"string"==typeof e.namespaceURI&&"function"==typeof e.insertBefore),It=e=>"object"==typeof mt?e instanceof mt:e&&"object"==typeof e&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName;var Ht=({classRegistry:e,console:t,cspSandboxCheck:n,documentView:a,global:r,namespace:o,parent:i,SandboxSecurityError:l,title:s,toNativeObject:c,top:d,toVirtualObject:u},{defineProperties:m,isString:p})=>{const f=[],b=[],S=[],E=e=>{if(!["https:","http:"].includes(new d.URL(e,d.document.baseURI).protocol))throw new l(`Forbidden: url [${JSON.stringify(e)}]`)};return{console:t,constructor:e.get("Window"),customElements:u(i.customElements),localStorage:u(i.localStorage),name:o,navigator:u(i.navigator),self:r,window:r,document:(()=>{const e=i.document,t=u(a),n=e.createElement("html"),r=e.createElement("head"),o=e.createElement("title"),l=e.createElement("body");return o.textContent=s,r.appendChild(o),n.appendChild(r),n.appendChild(l),a.appendChild(n),t})(),location:m(u(i.location),{...["hash","host","hostname","href","origin","password","pathname","port","protocol","search","username"].reduce((e,t)=>(e[t]={enumerable:!0,get(){return i.location[t]},set(e){n("allow-top-navigation")&&(["href","protocol"].includes(t)&&E(e),i.location[t]=e)}},e),{}),...["assign","reload","replace"].reduce((e,t)=>(e[t]={enumerable:!0,value(...e){n("allow-top-navigation")&&(["assign","replace"].includes(t)&&E(e[0]),i.location[t](...e))}},e),{}),...{toString:{enumerable:!0,value(){return this.href}}}}),close(){r.closed||(this.dispatchEvent(new this.Event("beforeunload")),this.dispatchEvent(new this.Event("pagehide")),this.dispatchEvent(new this.Event("unload")),f.forEach(e=>this.clearTimeout(e)),b.forEach(e=>this.clearInterval(e)),S.forEach(e=>this.cancelAnimationFrame(e)),this.document.removeChild(this.document.documentElement),r.closed=!0)},setTimeout(e,...t){if(p(e))throw new l(`The first parameter must be a function`);return f.push(i.setTimeout(e.bind(this),...t))},clearTimeout(e){const t=f.indexOf(e);-1!==t&&(f.splice(t,1),i.clearTimeout(e))},setInterval(e,...t){if(p(e))throw new l(`The first parameter must be a function`);return b.push(i.setInterval(e.bind(this),...t))},clearInterval(e){const t=b.indexOf(e);-1!==t&&(b.splice(t,1),i.clearInterval(e))},requestAnimationFrame(e){return S.push(i.requestAnimationFrame(e.bind(this)))},cancelAnimationFrame(e){const t=S.indexOf(e);-1!==t&&(S.splice(t,1),i.cancelAnimationFrame(e))},getComputedStyle(e,t){const n=c(e),a=i.getComputedStyle(n,t);return u(a)},atob(){return i.atob(...arguments)},btoa(){return i.btoa(...arguments)}}};const{assign:kt,create:Vt,defineProperty:Ft,entries:_t,inherits:jt,setPrototypeOf:Wt}=se,Ut=kt({},se,{cspParser:function(e){return e.split(";").reduce((e,t)=>{const[n,...a]=t.trim().split(/\s+/g);return n&&!Object.prototype.hasOwnProperty.call(e,n)&&(e[n]=a),e},{})},isJavaScriptType:R,Sanitizer:class e{constructor(e={}){this.config=e}[yt](e,t,n){const a=this.config[e];a&&a.call(this,t,n,this.config)}[ht](e){const{allowElements:t,dropElements:n}=this.config;if(this[yt]("beforeSanitizeElements",e,null),Dt(e))return wt(e),!0;if(e.nodeName.match(/[\u0080-\uFFFF]/))return wt(e),!0;const a=e.nodeName.toLowerCase();if(this[yt]("uponSanitizeElement",e,{tagName:a,allowElements:t}),"script"===a&&!e.type)return wt(e),!0;if(("svg"===a||"math"===a)&&0!==e.querySelectorAll("p, br, form, table, h1, h2, h3, h4, h5, h6").length)return wt(e),!0;if(!It(e.firstElementChild)&&(!It(e.content)||!It(e.content.firstElementChild))&&/<[/\w]/g.test(e.innerHTML)&&/<[/\w]/g.test(e.textContent))return wt(e),!0;if(!this.isValidElement(a)){const t=!Nt.includes(a)&&n&&!n.includes(a);if(t&&!Mt.includes(a)){const t=e.parentNode,n=e.childNodes,a=n.length;for(let r=a-1;0<=r;--r)t.insertBefore(n[r].cloneNode(!0),e.nextSibling)}return wt(e),!0}return("noscript"===a||"noembed"===a)&&/<\/no(script|embed)/i.test(e.innerHTML)?(wt(e),!0):(this[yt]("afterSanitizeElements",e,null),!1)}isValidAttribute(e,t,n){const{allowAttributes:a,dropAttributes:r}=this.config,o=e.toLowerCase(),i=t.toLowerCase();if(("id"===i||"name"===i)&&(n in gt||n in Lt))return!1;if(0===i.indexOf("on")||"script"===o&&"type"===i&&R(n))return!1;if(lt.test(i));else if(st.test(i));else{if(r&&r.includes(i)||a&&a.length&&!a.includes(i))return!1;if(Ot.includes(i));else if(ct.test(n.replace(ut,"")));else if(("src"===i||"xlink:href"===i||"href"===i)&&"script"!==o&&0===n.indexOf("data:")&&At.includes(o));else if(!dt.test(n.replace(ut,"")));else if(!n);else return!1}return!0}isValidElement(e){const{allowElements:t,blockElements:n,dropElements:a}=this.config,r=e.toLowerCase();return!Nt.includes(r)&&!(a&&a.includes(r)||n&&n.includes(r)||t&&t.length&&!t.includes(r))}[vt](e){const{allowAttributes:t}=this.config,n=e.nodeName;let a,r,o,i;this[yt]("beforeSanitizeAttributes",e,null);const{attributes:s}=e;if(s){const l={name:"",value:"",keep:!0,allowAttributes:t};for(i=s.length;i--;){a=s[i];const{name:t}=a;(r=a.value.trim(),o=t,l.name=o,l.value=r,l.keep=void 0,this[yt]("uponSanitizeAttribute",e,l),r=l.value,!l.keep)&&(this.isValidAttribute(n,o,r)||Rt(t,e))}this[yt]("afterSanitizeAttributes",e,null)}}[Tt](e){let t;const n=xt(e);for(this[yt]("beforeSanitizeShadowDOM",e,null);t=n.nextNode();)(this[yt]("uponSanitizeShadowNode",t,null),!this[ht](t))&&(t.content instanceof Et&&this[Tt](t.content),this[vt](t));this[yt]("afterSanitizeShadowDOM",e,null)}[Ct](e,t){e=`${e}`;const n=Pt(e);if(!n)return t?gt.createDocumentFragment():"";const a=xt(n);for(let n;n=a.nextNode();)this[ht](n)||(n.content instanceof Et&&this[Tt](n.content),this[vt](n));if(t){const e=n.ownerDocument.createDocumentFragment();if(n)for(;n.firstChild;)e.appendChild(n.firstChild);return e}const r=n.innerHTML;return r}sanitize(e){return this[Ct](e,!0)}sanitizeToString(e){return this[Ct](e)}}});Ut.utils=Ut;const Bt={CustomElementRegistry:({bindObject:e,elementDefined:t,global:n,parent:a,setCurrentNativeObject:r,toNativeObject:o},{create:i,construct:l,setPrototypeOf:s,inherits:c})=>{const d=new Map,u=new Map;return{define(e,t,a={}){if(!e.includes("-")||u.has(e))throw new TypeError(`Illegal constructor`);u.set(e,{constructor:t,observedAttributes:t.observedAttributes||[],options:a}),n.document.querySelectorAll(a.extends?`${a.extends}[is="${e}"]`:e).forEach(e=>{this.upgrade(e)})},get(e){const t=u.get(e);return t?t.constructor:void 0},upgrade(n){const m=n.getAttribute("is")||n.localName,p=u.get(m);if(p&&!(n instanceof p.constructor)){const u=o(n);r(u);const f=l(p.constructor,[]);if(r(null),s(n,c(f,i(p.constructor.prototype))),u.setAttribute(t,""),p.observedAttributes.length&&n.attributeChangedCallback){const e=new a.MutationObserver(e=>{e.forEach(({target:e,attributeName:t,oldValue:a})=>{n.attributeChangedCallback(t,a,e.getAttribute(t))})});e.observe(u,{attributes:!0,attributeOldValue:!0,attributeFilter:p.observedAttributes})}if(e(n,u),d.has(m))for(let e;e=d.get(m).shift();)e()}},whenDefined(e){return u.get(e)?Promise.resolve():new Promise((t)=>{d.has(e)||d.set(e,[]),d.get(e).push(t)})}}},Document:({getCurrentScript:e,global:t,parent:n,SandboxSecurityError:a,sanitizer:r,toNativeAny:o,toVirtualAny:i},{defineProperty:l,keys:s})=>{const c=new WeakMap,d=n.document,u=e=>function(){const t=Array.from(arguments).map(e=>o(e)),a=n.document[e](...t),r=i(a);return r},m=e=>function(...o){const l={createElement:{name:o[0],options:o[1]},["createElementNS"]:{ns:o[0],name:o[1],options:o[2]}}[e];if(!r.isValidElement(l.name)||n.customElements.get(l.name))throw new a(`Forbidden: tag <${l.name} />`);const s=n.document[e](...o);l.options&&s.setAttribute("is",l.options.is);const c=i(s);return t.customElements.upgrade(c),c},p=u("adoptNode"),f=u("createAttribute"),b=u("createAttributeNS"),S=u("createCDATASection"),E=u("createComment"),g=u("createDocumentFragment"),y=m("createElement"),h=m("createElementNS"),v=u("createEvent"),T=u("createNodeIterator"),C=u("createProcessingInstruction"),N=u("createTextNode"),M=u("createTreeWalker"),A=u("importNode"),O={adoptNode:p,get body(){return this.querySelector("body")},get characterSet(){return d.characterSet},get contentType(){return d.contentType},createAttribute:f,createAttributeNS:b,createCDATASection:S,createComment:E,createDocumentFragment:g,createElement:y,createElementNS:h,createEvent:v,createNodeIterator:T,createProcessingInstruction:C,createTextNode:N,createTreeWalker:M,get currentScript(){return e()},get defaultView(){return t},get documentElement(){return this.querySelector("html")},get documentURI(){return d.documentURI},get domain(){return d.domain},get head(){return this.querySelector("head")},get hidden(){return d.hidden},importNode:A,get readyState(){return d.readyState},get title(){return this.querySelector("title").textContent},set title(e){this.querySelector("title").textContent=e},get URL(){return d.URL},get visibilityState(){return d.visibilityState}};return s(n.Document.prototype).filter(e=>/^on[\w\W]+$/.test(e)).forEach(e=>{l(O,e,{enumerable:!0,configurable:!0,get(){const t=c.get(this);return t&&t[e]||null},set(t){const n=e.replace("on",""),a=this[e];c.has(this)||c.set(this,{}),a&&this.removeEventListener(n,a),this.addEventListener(n,t),c.get(this)[e]=t}})}),O},Element:({prefix:e,SandboxSecurityError:t,sanitizer:n,toNativeAny:a,toNativeObject:r})=>{const o=(o,i)=>function(){const[l,s]=i(arguments),c=Array.from(arguments).map(e=>a(e)),d=r(this),u=d.nodeName;if(!n.isValidAttribute(u,l,s)||0===l.indexOf(e)||0===s.indexOf(e))throw new t(`Forbidden: attribute [${l}=${JSON.stringify(s)}]`);const m=d[o](...c);return m};return{set innerHTML(e){const t=r(this),a=n.sanitize(e);for(;t.firstChild;)t.removeChild(t.firstChild);"template"===t.nodeName.toLowerCase()?t.content.appendChild(a):t.appendChild(a)},get innerHTML(){return r(this).innerHTML},set outerHTML(e){const t=r(this),a=n.sanitize(e);t.parentNode.replaceChild(a,t)},get outerHTML(){return r(this).outerHTML},insertAdjacentHTML(e,t){const a=r(this),o=n.sanitize(t);return a.insertAdjacentElement(e,o)},removeAttribute:o("removeAttribute",e=>[e[0],""]),removeAttributeNS:o("removeAttributeNS",e=>[e[1],""]),setAttribute:o("setAttribute",e=>e),setAttributeNS:o("setAttributeNS",e=>[e[1],e[2]]),setAttributeNode:o("setAttributeNode",e=>[e[0].name,e[0].value]),setAttributeNodeNS:o("setAttributeNodeNS",e=>[e[0].name,e[0].value]),toggleAttribute:o("toggleAttribute",e=>[e[0],""])}},Event:({documentView:e,global:t,parent:n,toNativeObject:a,toVirtualObject:r})=>({get composed(){return!1},composedPath(){const o=a(this).composedPath();return o.filter(t=>t===n||t instanceof n.Node&&e.contains(t)).map(e=>e===n?t:r(e))}}),HTMLScriptElement:({classRegistry:e,cspSandboxCheck:t,getCurrentNativeObject:n,runScript:a,SandboxSecurityError:r,sanitizer:o,scriptType:i,symbols:l,toNativeObject:s,top:c},{isNull:d})=>{const u=i,m=(e,t,n)=>{if(!o.isValidAttribute(e.nodeName,t,n))throw new r(`Forbidden: attribute [${t}=${JSON.stringify(n)}]`)};return{[l.initialize](){return n().setAttribute("type",u),this},get src(){const e=s(this),t=e.getAttribute("src");return d(t)?"":new c.URL(t,this.baseURI).href},set src(e){if(t("allow-import-scripts")){const t=s(this);m(t,"src",e),t.setAttribute("src",e)}},get type(){const e=s(this),t=e.getAttribute("type");return d(t)?"":t},set type(e){const t=s(this);m(t,"type",e),t.setAttribute("type",e)},[l.connectedCallback](){const t=s(this);if(t.getAttribute("type")!==u)return;const n=e.get("Event");a({element:this,src:this.src,textContent:this.textContent}).then(()=>{this.dispatchEvent(new n("load"))},()=>{this.dispatchEvent(new n("error"))})}}},Node:({global:e,parent:t,toNativeObject:n})=>({get ownerDocument(){const t=e.document;return t===this?null:t},get nodeName(){const a=e.document,r=a===this?t.document:n(this);return r.nodeName},get nodeType(){const a=e.document,r=a===this?t.document:n(this);return r.nodeType}}),ShadowRoot:({toNativeObject:e,sanitizer:t})=>({set innerHTML(n){const a=e(this),r=t.sanitize(n);for(;a.firstChild;)a.removeChild(a.firstChild);a.appendChild(r)},get innerHTML(){return e(this).innerHTML}}),Storage:({getCurrentNativeObject:e,namespace:t,prefix:n,symbols:a,toNativeObject:r,toVirtualObject:o},{inherits:i,isString:l,keys:s})=>{const c=`${n}${t}.`,d=e=>s(e).filter(e=>0===e.indexOf(c));return{[a.initialize](){return i(this,new Proxy(e(),{get(e,t){const n=o(e);return l(t)?n.getItem(t):void 0},set(e,t,n){const a=o(e);return!!l(t)&&(a.setItem(t,n),!0)},deleteProperty(e,t){const n=o(e);return!!l(t)&&(n.removeItem(t),!0)}}))},get length(){const e=r(this);return d(e).length},key(e){const t=r(this);return d(t).map(e=>e.replace(c,""))[e]},getItem(e){return r(this).getItem(`${c}${e}`)},setItem(e,t){return r(this).setItem(`${c}${e}`,t)},removeItem(e){return r(this).removeItem(`${c}${e}`)},clear(){const e=r(this);d(e).forEach(t=>e.removeItem(t))}}}},zt=e=>{const t={};return _t(Bt).forEach(([n,a])=>{t[n]=e.runFunction(a)}),e.interfaceGenerator(t,rt)},Gt=e=>e.runFunction(Ht);var Kt=e=>{e.permissions=it,e.compartment=e.compartment||nt();const t=e.compartment.global,n=e.parent,a=e.windowView,r=e.documentView,o=ue(e,Ut),{bindObject:i,classRegistry:l,compartment:s,console:c,createVirtualClass:d,getCurrentNativeObject:u,runScript:m,symbols:p,toLiveVirtuaObject:f,toVirtualObject:b}=o;["Object","Array","Promise"].forEach(e=>{l.set(e,d(e,{[p.initialize](){return jt(this,f(u()))}}))}),kt(t,zt(o)),kt(t,Gt(o)),i(t,a),Wt(t,Vt(l.get("Window").prototype)),["window","document","location"].forEach(e=>{Ft(t,e,{enumerable:!0})}),n.addEventListener("hashchange",e=>{const n=b(new e.constructor(e.type,{newUrl:e.newURL,oldURL:e.oldURL}));t.dispatchEvent(n)});const S=e=>{const n=b(e);n[p.connectedCallback]?n[p.connectedCallback]():t.customElements.get(n.localName)&&n.connectedCallback&&n.connectedCallback(),e.childNodes.forEach(S)},E=e=>{const n=b(e);n[p.disconnectedCallback]?n[p.disconnectedCallback]():t.customElements.get(n.localName)&&n.disconnectedCallback&&n.disconnectedCallback(),e.childNodes.forEach(E)},g=new n.MutationObserver(e=>{e.forEach(e=>{if("childList"===e.type){const{addedNodes:t,removedNodes:n}=e;try{t.forEach(S),n.forEach(E)}catch(e){c.error(e)}}})});return g.observe(r,{childList:!0,subtree:!0}),at(o),{global:t,evaluate(){return s.evaluate(...arguments)},async bootstrap({src:e,srcdoc:t}){return m({src:e,textContent:t})},async unload(){t.close()}}};let qt,Xt=0;const Yt=Symbol("closed"),Qt=Symbol("virtual-browser");class Jt extends HTMLElement{constructor(){if(super(),!qt){const e=document.createElement("style"),t="contain"in this.style?"contain: layout":"transform: scale(1)";e.textContent=`${this.localName} { ${t} }`,document.head.appendChild(e),qt=!0}Reflect.defineProperty(this,"debug",{configurable:!0,value:(()=>{}).toString().includes("*"),writable:!0})}get name(){return this.getAttribute("name")||""}set name(e){this.setAttribute("name",e)}get src(){const e=this.getAttribute("src");return null===e?"":new URL(e,this.baseURI).href}set src(e){this.setAttribute("src",e)}get srcdoc(){return this.getAttribute("srcdoc")||""}set srcdoc(e){this.setAttribute("srcdoc",e)}get csp(){return this.getAttribute("csp")||""}set csp(e){this.setAttribute("csp",e)}get contentWindow(){return this[Qt].global}get contentDocument(){return this[Qt].global.document}evaluate(){return this[Qt].evaluate(...arguments)}connectedCallback(){if(this[Yt])throw TypeError(`The <web-sandbox> has been destroyed`);this[Qt]=Kt({csp:this.csp,debug:this.debug,documentView:this.attachShadow({mode:"closed"}),namespace:this.name||`sandbox${Xt}`,parent:window,title:this.name,top:window,windowView:this}),this[Qt].bootstrap({src:this.src,srcdoc:this.srcdoc}).then(()=>{this.dispatchEvent(new Event("load"))},()=>{this.dispatchEvent(new Event("error"))}),Xt++}disconnectedCallback(){this[Qt].unload(),this[Yt]=!0}}window.HTMLWebSandboxElement=Jt,window.WebSandbox=L,window.customElements.define("web-sandbox",Jt),e.HTMLWebSandboxElement=Jt,e.WebSandbox=L,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=web-sandbox.umd.js.map
